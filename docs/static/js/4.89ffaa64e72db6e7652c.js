webpackJsonp([4],{MbJy:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=s("mvHQ"),a=s.n(e),n=s("FA3I"),o=s("mh9U"),l={props:{scale:{type:Number,default:2.5},url:{type:String,required:!0},bigUrl:{type:String,default:null},scroll:{type:Boolean,default:!1},showEidt:{type:Boolean,default:!1}},data:function(){return{id:null,cover:null,imgbox:null,imgwrap:null,orginUrl:null,bigImgUrl:null,bigOrginUrl:null,imgUrl:null,img:null,canvas:null,ctx:null,rectTimesX:0,rectTimesY:0,imgTimesX:0,imgTimesY:0,init:!1,step:0,bigStep:0,vertical:!1,showImg:!0}},created:function(){for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",i=t.length,s="",e=0;e<10;e++)s+=t.charAt(Math.floor(Math.random()*i));this.id=s,this.imgUrl=this.url,this.orginUrl=this.url,this.bigImgUrl=this.bigUrl,this.bigOrginUrl=this.bigUrl},watch:{url:function(t){this.imgUrl=t,this.orginUrl=t,this.initTime()},bigUrl:function(t){function i(){return t.apply(this,arguments)}return i.toString=function(){return t.toString()},i}(function(){this.bigImgUrl=bigUrl,this.bigOrginUrl=bigUrl,this.initTime()})},mounted:function(){var t=this;this.$nextTick(function(){t.initTime()})},methods:{initTime:function(){var t=this;this.init=!1;var i=this.$refs[this.id];this.imgbox=i,this.cover=i.querySelector(".mouse-cover"),this.cover.style.width=this.imgbox.offsetWidth/this.scale+"px",this.cover.style.height=this.imgbox.offsetHeight/this.scale+"px",this.cover.style.left="-100%",this.cover.style.top="-100%",this.imgwrap=i.querySelector("img");var s=void 0;s=this.bigImgUrl?this.bigImgUrl:this.imgUrl,this.img=new Image,this.img.src=s,this.img.onload=function(){t.rectTimesX=t.imgbox.offsetWidth/t.scale/t.imgwrap.offsetWidth,t.rectTimesY=t.imgbox.offsetHeight/t.scale/t.imgwrap.offsetHeight,t.imgTimesX=t.img.width/t.imgwrap.offsetWidth,t.imgTimesY=t.img.height/t.imgwrap.offsetHeight,t.vertical=t.img.width<t.img.height,t.init=!0},this.canvas&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this.canvas=document.createElement("canvas"),this.canvas.className="mouse-cover-canvas",this.canvas.style.position="absolute",this.canvas.style.left=this.imgbox.offsetLeft+this.imgbox.offsetWidth+10+"px",this.canvas.style.top=this.imgbox.offsetTop+"px",this.canvas.style.border="1px solid #eee",this.canvas.style.zIndex="99999",this.canvas.height=this.imgbox.offsetHeight,this.canvas.width=this.imgbox.offsetWidth,this.canvas.style.display="none",document.body.append(this.canvas),this.ctx=this.canvas.getContext("2d"),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},initBox:function(){var t=this;this.showImg=!1,this.canvas.style.display="none";var i=this.$refs[this.id],s=void 0;s=this.bigImgUrl?this.bigImgUrl:this.imgUrl,this.img=new Image,this.img.src=s,this.img.onload=function(){t.vertical=t.img.width<t.img.height,t.showImg=!0;i.querySelector("img");setTimeout(function(){t.rectTimesX=t.imgbox.offsetWidth/t.scale/i.querySelector("img").offsetWidth,t.rectTimesY=t.imgbox.offsetHeight/t.scale/i.querySelector("img").offsetHeight},20)}},mousemove:function(t){if(!this.init)return!1;var i=this;var s,e=t||event,a={x:(s=e).clientX-i.cover.offsetWidth/2,y:s.clientY-i.cover.offsetHeight/2},n=function(t){var i=null,s=null,e=t.offsetParent;for(i+=t.offsetLeft,s+=t.offsetTop;e;)-1===navigator.userAgent.indexOf("MSIE 8.0")&&(i+=e.clientLeft,s+=e.clientTop),i+=e.offsetLeft,s+=e.offsetTop,e=e.offsetParent;return{left:i,top:s}}(this.imgwrap),o={minX:n.left,maxX:n.left+this.imgwrap.offsetWidth-this.cover.offsetWidth,minY:n.top-document.documentElement.scrollTop,maxY:n.top-document.documentElement.scrollTop+this.imgwrap.offsetHeight-this.cover.offsetHeight};a.x>o.maxX&&(a.x=o.maxX),a.x<o.minX&&(a.x=o.minX),a.y>o.maxY&&(a.y=o.maxY),a.y<o.minY&&(a.y=o.minY),this.cover.style.left=a.x+"px",this.cover.style.top=a.y+"px",this.ctx.clearRect(0,0,this.imgwrap.offsetWidth,this.imgwrap.offsetHeight);var l=a.x-(n.left-document.documentElement.scrollLeft),r=a.y-(n.top-document.documentElement.scrollTop);this.ctx.drawImage(this.img,l*this.imgTimesX,r*this.imgTimesY,this.img.width*this.rectTimesX,this.img.height*this.rectTimesY,0,0,this.imgbox.offsetWidth,this.imgbox.offsetHeight)},mouseover:function(t){if(!this.init)return!1;t=t||event,this.scroll||(t.currentTarget.addEventListener("mousewheel",function(t){t.preventDefault()},!1),t.currentTarget.addEventListener("DOMMouseScroll",function(t){t.preventDefault()},!1)),this.cover.style.display="block",this.canvas.style.display="block"},mouseleave:function(){if(!this.init)return!1;this.cover.style.display="none",this.canvas.style.display="none"},rotate:function(t){var i=this,s=new Image;if(s.crossOrigin="Anonymous",s.src=this.orginUrl,s.onload=function(){i.rotateImg(s,t,i.step)},this.bigOrginUrl){var e=new Image;s.crossOrigin="Anonymous",e.src=this.bigOrginUrl,e.onload=function(){i.rotateImg(e,t,i.bigStep,!0)}}},rotateImg:function(t,i,s){var e=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(null!=t){var n=t.height,o=t.width;null==s&&(s=0),"right"==i?++s>3&&(s=0):--s<0&&(s=3);var l=document.createElement("canvas"),r=90*s*Math.PI/180,c=l.getContext("2d");switch(l.width=n,l.height=o,c.rotate(r),c.drawImage(t,0,-n),s){case 0:l.width=o,l.height=n,c.drawImage(t,0,0);break;case 1:l.width=n,l.height=o,c.rotate(r),c.drawImage(t,0,-n);break;case 2:l.width=o,l.height=n,c.rotate(r),c.drawImage(t,-o,-n);break;case 3:l.width=n,l.height=o,c.rotate(r),c.drawImage(t,-o,0)}var h=l.toDataURL();a?(this.bigImgUrl=h,this.bigStep=s,this.initBox()):(this.imgUrl=h,this.step=s,this.$nextTick(function(){e.initBox()}))}}}},r={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{ref:t.id,staticClass:"magnifier-box",class:t.vertical?"vertical":"",on:{mousemove:t.mousemove,mouseover:t.mouseover,mouseleave:t.mouseleave}},[s("img",{directives:[{name:"show",rawName:"v-show",value:t.showImg,expression:"showImg"}],attrs:{src:t.imgUrl,alt:""}}),t._v(" "),s("div",{staticClass:"mouse-cover"}),t._v(" "),t.showEidt?s("div",{staticClass:"edit-wrap"},[s("span",{staticClass:"rotate-left",on:{click:function(i){return t.rotate("left")}}}),t._v(" "),s("span",{staticClass:"rotate-right",on:{click:function(i){return t.rotate("right")}}})]):t._e()])},staticRenderFns:[]};var c=s("VU/8")(l,r,!1,function(t){s("zNU5")},"data-v-f9b02836",null).exports,h={name:"Comments",data:function(){return{comments:[]}},created:function(){var t=this;this.$axios({type:"get",url:"http://localhost:8080/api/comments"}).then(function(i){console.log(i.data.comments),t.comments=i.data.comments}).catch(function(t){console.log(t)})}},m={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"comment"},[s("el-divider",[t._v("用户评论")]),t._v(" "),t._l(t.comments,function(i,e){return s("div",{key:e},[s("el-card",{attrs:{shadow:"hover"}},[s("div",{staticClass:"box"},[s("div",{staticClass:"head"},[s("div",{staticClass:"img"},[s("el-avatar",{attrs:{src:i.headImg}}),t._v(" "),s("span",[t._v("\n              "+t._s(i.name)+"\n            ")])],1),t._v(" "),s("div",[i.isVIP?s("el-tag",{attrs:{type:"primary",size:"small"}},[t._v("\n              PLUS会员\n            ")]):t._e(),t._v(" "),i.isVIP?t._e():s("el-tag",{attrs:{type:"info",size:"small"}},[t._v("\n              普通会员\n            ")])],1)]),t._v(" "),s("div",{staticClass:"right"},[s("div",{staticClass:"stars"},[s("el-rate",{attrs:{value:i.star,disabled:"","show-text":"","text-color":"#ff9900"}}),t._v(" "),s("div",{staticClass:"time"},[t._v("\n              "+t._s(i.datetime)+"\n            ")])],1),t._v(" "),s("div",{staticClass:"content"},[t._v("\n            "+t._s(i.content)+"\n          ")])])])]),t._v(" "),s("el-divider")],1)})],2)},staticRenderFns:[]};var v=s("VU/8")(h,m,!1,function(t){s("hFql")},"data-v-6825902e",null).exports,g={name:"Detail",components:{HeaderPart:n.a,SearchSimple:o.a,PicZoom:c,Comments:v},data:function(){return{goodsDeatail:"",sku:this.$route.params.id,index:0,imgs:[],num:1,isShow:!1,left:0,imgWidth:60,meanwhileNum:6,tagIndex:0,tagList:["官方标配","珊瑚蓝","耀世金","星空灰","梦幻粉"]}},computed:{getPrice:function(t){return this.goodsDeatail["价格"]-0+100*this.tagIndex||0},getMainImg:function(){return this.imgs[this.index]},getCanshu:function(){return(this.goodsDeatail["商品基本参数"]||"").split("\n").splice(1)},imgNum:function(){return this.imgs.length||0}},methods:{getTagType:function(t){return this.tagIndex===t?"primary":"info"},moveLeft:function(){this.left<0&&(this.$refs.innerBox.style.transform="translateX("+(this.left+60)+"px)",this.left+=60)},moveRight:function(){0-(this.imgNum-this.meanwhileNum)*this.imgWidth<this.left&&(this.$refs.innerBox.style.transform="translateX("+(this.left-60)+"px)",this.left-=60)},hoverImg:function(t){this.index=t},getDivied:function(t){return(this.goodsDeatail["价格"]/t||5e3).toFixed(2)},addToCart:function(){var t=this,i=this.goodsDeatail;i.num=this.num;var s=JSON.parse(localStorage.getItem("users")),e=this.$store.state.userInfo;if(null===e)this.$message({showClose:!0,message:"尊敬的用户，请您先完成登录!",type:"info"}),this.$router.push("/PC/login?isLogin=true");else{this.isShow=!0,setTimeout(function(){t.isShow=!1},1e3);var n=s.filter(function(t){return t.username===e.username})[0];console.log(n);var o=this.isHaveThisGoods(n,i);if(console.log(o),o){for(var l=n.carts,r=0;r<l.length;r++)l[r].sku===i.sku&&(l[r].num+=i.num);console.log(n.carts),n.carts=l}else n.carts.push(i);this.$store.state.userInfo=n;var c=s.find(function(t){return t.username==e.username});console.log("该用户对应的索引是"+s.indexOf(c)),s.splice(s.indexOf(c),1,n),localStorage.setItem("users",a()(s)),this.$store.commit("updateUsers",s)}},switchTag:function(t){this.tagIndex=t},isHaveThisGoods:function(t,i){var s=t.carts.filter(function(t){return t.sku===i.sku});return console.log(s),0!==s.length}},beforeCreate:function(){var t=this;this.$axios({type:"get",url:"/static/data/goodsDetails.json"}).then(function(i){console.log("执行了生命周期函数");var s=i.data.filter(function(i){return i.sku==t.$route.params.id});t.goodsDeatail=s[0];var e=t.goodsDeatail["轮播图"].split("/\r\n");e[e.length-1]=e[e.length-1].substring(0,e[e.length-1].length-1),t.imgs=e}).catch(function(t){console.log(t)})}},d={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",[s("header-part"),t._v(" "),s("search-simple"),t._v(" "),s("div",{staticClass:"toImg"},[s("transition",{attrs:{name:"shop_cart"}},[t.isShow?s("img",{staticClass:"my_img",attrs:{src:t.imgs[0],alt:"",width:"80px",height:"80px"}}):t._e()])],1),t._v(" "),s("div",{staticClass:"detail"},[s("div",{staticClass:"core"},[s("div",{staticClass:"top",staticStyle:{display:"flex"}},[s("div",{staticClass:"imgs"},[s("div",{staticClass:"mainImg"},[s("pic-zoom",{attrs:{url:t.getMainImg||"/static/loading.png",scale:2}})],1),t._v(" "),s("div",{staticClass:"outerBox"},[s("div",{staticClass:"rowBtn left",on:{click:t.moveLeft}},[s("i",{staticClass:"el-icon-arrow-left"})]),t._v(" "),s("div",{staticClass:"box"},[s("div",{ref:"innerBox",staticClass:"innerBox"},t._l(t.imgs,function(i,e){return s("div",{key:e,staticClass:"imgItem inline-block",on:{mouseover:function(i){return t.hoverImg(e)}}},[s("img",{attrs:{src:i,alt:"图片",width:"60px",height:"60px"}})])}),0)]),t._v(" "),s("div",{staticClass:"rowBtn left",on:{click:t.moveRight}},[s("i",{staticClass:"el-icon-arrow-right"})])])]),t._v(" "),s("div",{staticClass:"right"},[s("div",{staticClass:"title"},[t._v("\n            "+t._s(t.goodsDeatail["标题"])+"\n          ")]),t._v(" "),s("div",{staticClass:"subtitle",staticStyle:{color:"#e4393c","font-size":"12px"}},[t._v("\n            新品速发！【购机送豪礼：白条6期免息+多重豪礼++运费险+嗮图赠价值199元运动蓝牙耳几】4000毫安电池，1600万像素，人脸识别！\n          ")]),t._v(" "),t._m(0),t._v(" "),s("div",{staticClass:"valueCard"},[s("div",{staticClass:"value"},[s("span",{staticClass:"label"},[t._v("秒杀价：")]),t._v(" "),s("span",{staticClass:"rmb"},[t._v("¥")]),t._v(" "),s("span",{domProps:{textContent:t._s(t.getPrice)}})]),t._v(" "),s("div",{staticClass:"cuxiao"},[s("span",{staticClass:"label"},[t._v("促销品：")]),t._v(" "),s("span",{staticClass:"free"},[s("span",[s("el-tag",{attrs:{type:"danger",size:"small",effect:"plain"}},[t._v("\n                    赠品\n                  ")])],1),t._v(" "),t._l(4,function(i,e){return s("span",{key:e},[s("img",{staticStyle:{"vertical-align":"text-bottom"},attrs:{src:"/static/images/promotion/4.jpg",alt:"信息",title:"新品速发 6+128G 6.3吋珍珠全面屏学生游戏智能手机 炫彩玻璃机身 侧面指纹 梦幻蓝(全网通5G+64G)",width:"30px",height:"30px"}}),t._v(" "),s("span",{staticClass:"multi"},[t._v("×1")])])})],2),t._v(" "),s("div",{staticClass:"limitBuy"},[s("el-tag",{attrs:{type:"danger",size:"small",effect:"plain"}},[t._v("\n                  限购\n                ")]),t._v(" "),s("span",{staticClass:"des"},[t._v("\n                  该商品购买1-20件时享受单件价秒杀价，超出数量以结算价为准，仅限购买一次\n                ")])],1)])]),t._v(" "),s("el-divider"),t._v(" "),s("div",{staticClass:"buyType"},[s("div",[s("span",{staticClass:"label"},[t._v(" 选择款式： ")]),t._v(" "),t._l(t.tagList,function(i,e){return s("span",{key:e,staticClass:"inline-block",staticStyle:{margin:"0 8px 0 0"}},[s("el-tag",{attrs:{type:t.getTagType(e),size:"small",effect:"plain"},on:{click:function(i){return t.switchTag(e)}}},[t._v(t._s(i))])],1)})],2),t._v(" "),s("div",[s("span",{staticClass:"label"},[t._v(" 增值服务: ")]),t._v(" "),s("el-button",{attrs:{size:"mini"}},[s("i",{staticClass:"el-icon-mobile-phone"}),t._v("\n                三年质保")]),t._v(" "),s("el-button",{attrs:{size:"mini"}},[s("i",{staticClass:"el-icon-mobile-phone"}),t._v("\n                二年更换电池\n              ")]),t._v(" "),s("el-button",{attrs:{size:"mini"}},[s("i",{staticClass:"el-icon-mobile-phone"}),t._v("\n                一年换新")])],1),t._v(" "),s("div",[s("span",{staticClass:"label"},[t._v(" 白条分期: ")]),t._v(" "),s("el-button",{attrs:{size:"mini"}},[s("i",{staticClass:"el-icon-money"}),t._v("\n                "+t._s(t.goodsDeatail["价格"])+" × 不分期\n              ")]),t._v(" "),s("el-button",{attrs:{size:"mini"}},[s("i",{staticClass:"el-icon-tickets"}),t._v("\n                ¥"+t._s(t.getDivied(3))+" × 3期\n              ")]),t._v(" "),s("el-button",{attrs:{size:"mini"}},[s("i",{staticClass:"el-icon-tickets"}),t._v("\n                ¥"+t._s(t.getDivied(6))+"×6期\n              ")]),t._v(" "),s("el-button",{attrs:{size:"mini"}},[s("i",{staticClass:"el-icon-tickets"}),t._v("\n                ¥"+t._s(t.getDivied(12))+"×12期\n              ")])],1)]),t._v(" "),s("el-divider"),t._v(" "),s("div",{staticClass:"buyArea"},[s("div",{staticClass:"label"},[t._v("数量：")]),t._v(" "),s("div",[s("el-input-number",{attrs:{size:"small","controls-position":"right",min:1,max:10},model:{value:t.num,callback:function(i){t.num=i},expression:"num"}})],1),t._v(" "),s("div",[s("el-button",{attrs:{type:"danger"},on:{click:t.addToCart}},[t._v("加入购物车")])],1)]),t._v(" "),s("div",{staticClass:"text",staticStyle:{"font-size":"14px",color:"#aaa"}},[t._v("\n            温馨提示 · 支持7天无理由退货\n          ")])],1)]),t._v(" "),s("div",{staticClass:"bottom"},[s("div",{staticClass:"shopCard"},[s("el-card",{attrs:{shadow:"hover","body-style":"padding:0px"}},[s("div",{staticClass:"shopTitle"},[t._v("\n              "+t._s(t.goodsDeatail["店铺名称"]||"常开泰达手机店")+"\n            ")]),t._v(" "),s("div",{staticStyle:{"margin-left":"8px","margin-top":"6px"}},[s("div",{staticClass:"star",staticStyle:{display:"flex"}},[s("span",[t._v("店铺星级")]),t._v(" "),s("el-rate",{attrs:{value:4.5,disabled:"","text-color":"#ff9900","score-template":"{value}"}})],1),t._v(" "),s("div",{staticClass:"goodsComment"},[s("span",[t._v("商品评价")]),t._v(" "),s("span",{staticClass:"comment"},[t._v(" 9.65 高 ")])]),t._v(" "),s("div",{staticClass:"goodsComment"},[s("span",[t._v("物流旅约")]),t._v(" "),s("span",{staticClass:"comment"},[t._v("9.28 高")])]),t._v(" "),s("div",{staticClass:"goodsComment"},[s("span",[t._v("售后服务")]),t._v(" "),s("span",{staticClass:"comment"},[t._v("9.39 高")])])]),t._v(" "),s("el-divider"),t._v(" "),s("div",{staticClass:"allCenter",staticStyle:{padding:"0 4px 20px"}},[s("el-button",{attrs:{size:"small",round:""}},[s("i",{staticClass:"el-icon-shopping-bag-2"}),t._v("\n                进店逛逛\n              ")]),t._v(" "),s("el-button",{attrs:{size:"small",round:""}},[s("i",{staticClass:"el-icon-star-on"}),t._v("\n                关注店铺\n              ")])],1)],1)],1),t._v(" "),s("div",{staticClass:"bottomRight"},[s("el-tabs",{attrs:{type:"border-card"}},[s("el-tab-pane",{attrs:{label:"商品详情"}},[s("div",{domProps:{innerHTML:t._s(t.goodsDeatail["详情HTML"])}})]),t._v(" "),s("el-tab-pane",{attrs:{label:"规格与包装"}},[s("div",{staticClass:"sizeBox",staticStyle:{color:"#aaa"}},t._l(t.getCanshu,function(i,e){return s("div",{key:e,staticStyle:{width:"350px"}},[t._v("\n                  "+t._s(i)+"\n                ")])}),0)]),t._v(" "),s("el-tab-pane",{attrs:{label:"商品评论"}},[s("comments")],1)],1)],1)])])])],1)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"secKill"},[i("i",{staticClass:"el-icon-alarm-clock",staticStyle:{"font-size":"18px"}}),this._v(" "),i("span",[this._v("商城秒杀")])])}]};var u=s("VU/8")(g,d,!1,function(t){s("XPvz")},"data-v-6d9eb624",null);i.default=u.exports},XPvz:function(t,i){},hFql:function(t,i){},zNU5:function(t,i){}});
//# sourceMappingURL=4.89ffaa64e72db6e7652c.js.map